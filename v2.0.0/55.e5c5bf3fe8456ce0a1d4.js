/*! @version pwa-studio: 0.0.1, @magento/venia-ui: ^9.6.0, @magento/upward-security-headers: ~1.0.9, @magento/upward-js: ^5.3.2, @magento/pwa-theme-venia: ~1.3.0, @magento/pwa-buildpack: ^11.4.0, @magento/peregrine: ^12.5.1, @magento/pagebuilder: ^7.4.1, @magento/eslint-config: ^1.5.3, @magento/babel-preset-peregrine: ~1.2.1, @apollo/client: ~3.5.0 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{"1yLg":function(a,e,r){"use strict"
r.r(e),r.d(e,"default",function(){return aa})
var t,n,c,i,d=r("q1tI"),l=r.n(d),o=r("dDsW"),s=r("kriW"),g=r("8UhI"),f=r("QMhA"),u=r("yXPU"),m=r.n(u),C=r("+TN3"),p=r("Lm/n"),b=r("pZLH"),y=r("9872"),v=r("y1Xp"),_=r("VkAN"),h=r.n(_),k=r("UYTu"),E=r("JXKe"),O=r("jSIv"),G={getAppliedGiftCardsQuery:Object(k.a)(t||(t=h()(["\n    query getAppliedGiftCards($cartId: String!) {\n        cart(cart_id: $cartId) {\n            id\n            ...GiftCardFragment\n        }\n    }\n    ","\n"])),O.a),getGiftCardBalanceQuery:Object(k.a)(n||(n=h()(["\n    query getGiftCardBalance($giftCardCode: String!) {\n        giftCardAccount(input: { gift_card_code: $giftCardCode }) {\n            balance {\n                currency\n                value\n            }\n            code\n            expiration_date\n            id: code\n        }\n    }\n"]))),applyGiftCardMutation:Object(k.a)(c||(c=h()(['\n    mutation applyGiftCardToCart($cartId: String!, $giftCardCode: String!) {\n        applyGiftCardToCart(\n            input: { cart_id: $cartId, gift_card_code: $giftCardCode }\n        ) {\n            cart {\n                id\n                ...CartPageFragment\n                # If this mutation causes "free" to become available we need to know.\n                available_payment_methods {\n                    code\n                    title\n                }\n            }\n        }\n    }\n    ',"\n"])),E.a),removeGiftCardMutation:Object(k.a)(i||(i=h()(['\n    mutation removeGiftCard($cartId: String!, $giftCardCode: String!) {\n        removeGiftCardFromCart(\n            input: { cart_id: $cartId, gift_card_code: $giftCardCode }\n        ) {\n            cart {\n                id\n                ...CartPageFragment\n                # If this mutation causes "free" to become available we need to know.\n                available_payment_methods {\n                    code\n                    title\n                }\n            }\n        }\n    }\n    ',"\n"])),E.a)},j="apply",T="check",I="remove",L=a=>{var e=Object(v.a)(G,a.operations),{getAppliedGiftCardsQuery:r,getGiftCardBalanceQuery:t,applyGiftCardMutation:n,removeGiftCardMutation:c}=e,{setIsCartUpdating:i}=a,[{cartId:l}]=Object(y.b)(),o=Object(g.l)(),s=Object(C.a)(r,{fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first",skip:!l,variables:{cartId:l}}),[f,u]=Object(p.a)(t,{fetchPolicy:"no-cache"}),[_,h]=Object(b.a)(n),[k,E]=Object(b.a)(c),[O,L]=Object(d.useState)(null),B=Object(d.useCallback)(m()(function*(){L(j)
var a=o.getValue("card")
yield _({variables:{cartId:l,giftCardCode:a}}),o.reset()}),[o,_,l]),F=Object(d.useCallback)(()=>{L(T)
var a=o.getValue("card")
f({variables:{giftCardCode:a}})},[o,f]),N=Object(d.useCallback)(function(){var a=m()(function*(a){L(I)
try{yield k({variables:{cartId:l,giftCardCode:a}})}catch(a){}})
return function(e){return a.apply(this,arguments)}}(),[l,k]),{called:w,loading:M}=h,{called:x,loading:P}=E
Object(d.useEffect)(()=>{(w||x)&&i(M||P)},[w,M,x,P,i])
var A=O===T&&Boolean(u.data),D=O===j&&h.error||O===T&&u.error
return{applyGiftCard:B,checkBalanceData:u.data&&u.data.giftCardAccount,checkGiftCardBalance:F,errorLoadingGiftCards:Boolean(s.error),errorRemovingCard:Boolean(E.error),giftCardsData:s.data&&s.data.cart.applied_gift_cards||[],isLoadingGiftCards:s.loading,isApplyingCard:M,isCheckingBalance:u.loading,isRemovingCard:P,removeGiftCard:N,shouldDisplayCardBalance:A,shouldDisplayCardError:D}},B=r("J3e4"),F=r("17x9"),N=r("y+6n"),w=a=>{var{locale:e}=Object(o.a)(),{value:r,currencyCode:t,classes:n}=a,c=N.a.toParts.call(new Intl.NumberFormat(e,{style:"currency",currency:t}),r).map((a,e)=>{var r=n[a.type],t="".concat(e,"-").concat(a.value)
return l.a.createElement("span",{key:t,className:r},a.value)})
return l.a.createElement(d.Fragment,null,c)}
w.propTypes={classes:Object(F.shape)({currency:F.string,integer:F.string,decimal:F.string,fraction:F.string}),value:F.number.isRequired,currencyCode:F.string.isRequired},w.defaultProps={classes:{}}
var M=w,x=r("LGPB"),P=r("ACyH"),A=r("5kIi"),D=r("oTwF"),J=r("6QXU"),R=r("eYVk"),$=r("Hq+J"),S=r("LboF"),H=r.n(S),Q=r("zLjX"),X={injectType:"singletonStyleTag",insert:"head",singleton:!0},U=(H()(Q.a,X),Q.a.locals||{}),V=r("ZKBY"),W=r("GVTQ"),q={injectType:"singletonStyleTag",insert:"head",singleton:!0},K=(H()(W.a,q),W.a.locals||{}),Z=a=>{var{code:e,currentBalance:r,isRemovingCard:t,removeGiftCard:n}=a,{removeGiftCardWithCode:c}=(a=>{var{code:e,removeGiftCard:r}=a
return{removeGiftCardWithCode:Object(d.useCallback)(()=>{r(e)},[e,r])}})({code:e,removeGiftCard:n}),i=Object(v.a)(K,a.classes)
return l.a.createElement(d.Fragment,null,l.a.createElement("div",{className:i.card_info},l.a.createElement("span",{className:i.code},e),l.a.createElement("span",{className:i.balance},l.a.createElement(s.a,{id:"giftCard.balance",defaultMessage:"Balance: "}),l.a.createElement(V.a,{value:r.value,currencyCode:r.currency}))),l.a.createElement(J.a,{disabled:t,onClick:c},l.a.createElement(s.a,{id:"giftCard.remove",defaultMessage:"Remove"})))},Y=l.a.createElement(D.a,{src:f.a,attrs:{width:18}}),z=a=>{var e=L({setIsCartUpdating:a.setIsCartUpdating}),{applyGiftCard:r,checkBalanceData:t,checkGiftCardBalance:n,errorLoadingGiftCards:c,errorRemovingCard:i,giftCardsData:g,isLoadingGiftCards:f,isApplyingCard:u,isCheckingBalance:m,isRemovingCard:C,removeGiftCard:p,shouldDisplayCardBalance:b,shouldDisplayCardError:y}=e,_=Object(v.a)(U,a.classes),{formatMessage:h}=Object(o.a)(),[,{addToast:k}]=Object(B.a)()
if(Object(d.useEffect)(()=>{i&&k({type:"error",icon:Y,message:h({id:"giftCards.errorRemoving",defaultMessage:"Unable to remove gift card. Please try again."}),dismissable:!0,timeout:7e3})},[k,i,h]),f)return l.a.createElement(R.a,null,l.a.createElement(s.a,{id:"giftCards.loading",defaultMessage:"Loading Gift Cards..."}))
var E=y?h({id:"giftCards.errorInvalid",defaultMessage:"Invalid card. Please try again."}):null,O=null
if(c&&(O=l.a.createElement("span",{className:_.errorText},l.a.createElement(s.a,{id:"giftCards.errorLoading",defaultMessage:"There was an error loading applied gift cards. Please refresh and try again."}))),g.length>0){var G=g.map(a=>{var{code:e,current_balance:r}=a
return l.a.createElement(Z,{code:e,currentBalance:r,isRemovingCard:C,key:e,removeGiftCard:p})})
O=l.a.createElement("div",{className:_.cards_container},G)}var j=b&&l.a.createElement("div",{className:_.balance},l.a.createElement("span",{className:_.price},l.a.createElement(s.a,{id:"giftCards.balance",defaultMessage:"Balance: "}),l.a.createElement(M,{value:t.balance.value,currencyCode:t.balance.currency}))),T=y?_.card_input_container_error:_.card_input_container,I=l.a.createElement("div",{className:_.card},l.a.createElement(A.a,{classes:{root:_.entry},id:_.card,label:h({id:"giftCards.cardNumber",defaultMessage:"Gift Card Number"})},l.a.createElement("div",{className:T},l.a.createElement($.a,{id:_.card,disabled:u||m,field:"card",mask:a=>a&&a.trim(),maskOnBlur:!0,message:E,placeholder:h({id:"giftCards.cardEntry",defaultMessage:"Enter card number"}),validate:x.c})),j),l.a.createElement(A.a,{classes:{label:_.applyLabel}},l.a.createElement(P.a,{priority:"normal",disabled:u,onClick:r},l.a.createElement(s.a,{id:"giftCards.apply",defaultMessage:"Apply"}))),l.a.createElement(J.a,{className:_.check_balance_button,disabled:m,onClick:n},l.a.createElement(s.a,{id:"giftCards.checkBalance",defaultMessage:"Check balance"})))
return l.a.createElement("div",{className:_.root},l.a.createElement("div",{className:_.entryForm},I),O)},aa=a=>l.a.createElement(g.b,null,l.a.createElement(z,a))},"6QXU":function(a,e,r){"use strict"
var t=r("pVnL"),n=r.n(t),c=r("QILm"),i=r.n(c),d=r("q1tI"),l=r.n(d),o=r("17x9"),s=r("y1Xp"),g=r("LboF"),f=r.n(g),u=r("KOss"),m={injectType:"singletonStyleTag",insert:"head",singleton:!0},C=(f()(u.a,m),u.a.locals||{}),p=r("ACyH"),b=["children","classes","type"],y=a=>{var{children:e,classes:r,type:t}=a,c=i()(a,b),d=Object(s.a)(C,r)
return l.a.createElement(p.a,n()({priority:"normal",classes:{root_normalPriority:d.root},type:t},c),e)}
y.propTypes={classes:Object(o.shape)({root:o.string}),type:Object(o.oneOf)(["button","reset","submit"]).isRequired},y.defaultProps={type:"button"}
e.a=y},GVTQ:function(a,e,r){"use strict"
var t=r("JPst"),n=r.n(t)()(function(a){return a[1]})
n.push([a.i,".giftCard-card_info-TFA {\n}\n\n.giftCard-balance-b7r {\n}\n\n.giftCard-code-ZJO {\n}\n",""]),n.locals={card_info:"giftCard-card_info-TFA grid gap-y-2xs",balance:"giftCard-balance-b7r text-sm",code:"giftCard-code-ZJO"},e.a=n},zLjX:function(a,e,r){"use strict"
var t=r("JPst"),n=r.n(t),c=r("KOss"),i=r("CJ7a"),d=n()(function(a){return a[1]})
d.i(c.a,"",!0),d.i(i.a,"",!0),d.push([a.i,".giftCards-root-Hgt {\n}\n\n.giftCards-errorText-5Vu {\n}\n\n.giftCards-balance-1JD {\n    grid-template-columns: max-content 1fr;\n}\n\n.giftCards-card-F61 {\n    grid-template-areas:\n        'card_entry'\n        'check_balance_button'\n        'apply_button';\n}\n\n@media (min-width: 960px) {\n    .giftCards-card-F61 {\n        grid-template-areas:\n            'card_entry apply_button'\n            'check_balance_button check_balance_button';\n    }\n}\n\n.giftCards-card_input_container-ogL {\n}\n\n/* TODO @TW: cannot compose */\n.giftCards-card_input_container_error-t6H input {\n    /* composes: border-error from global; */\n    border-color: rgb(var(--venia-global-color-red-400));\n}\n\n/* TODO @TW: cannot compose */\n.giftCards-card_input_container_error-t6H input:focus {\n    /* composes: border-gray-600 from global; */\n    border-color: rgb(var(--venia-global-color-gray-600));\n}\n\n/* TODO @TW: cannot compose */\n.giftCards-card_input_container_error-t6H p {\n    /* composes: text-error from global; */\n    color: rgb(var(--venia-global-color-error));\n    /* composes: font-semibold from global; */\n    font-weight: 600;\n}\n\n.giftCards-cards_container-ogd {\n    grid-template-columns: max-content auto;\n}\n\n.giftCards-check_balance_button-JRl {\n    grid-area: check_balance_button;\n}\n\n.giftCards-entry-e3g {\n    grid-area: card_entry;\n}\n\n.giftCards-price-k2T {\n}\n\n.giftCards-entryForm-XoW {\n}\n\n.giftCards-applyLabel-sGo {\n}\n",""]),d.locals={root:"giftCards-root-Hgt grid gap-md",errorText:"giftCards-errorText-5Vu leading-normal text-error",balance:"giftCards-balance-1JD grid italic items-start pt-1.5 text-sm",card:"giftCards-card-F61 gap-sm grid grid-cols-1 items-start lg_grid-cols-autoLast",card_input_container:"giftCards-card_input_container-ogL",card_input_container_error:"giftCards-card_input_container_error-t6H",cards_container:"giftCards-cards_container-ogd gap-sm grid items-baseline justify-start",check_balance_button:"giftCards-check_balance_button-JRl "+c.a.locals.root+" justify-self-center lg_justify-self-start",entry:"giftCards-entry-e3g",price:"giftCards-price-k2T",entryForm:"giftCards-entryForm-XoW",applyLabel:"giftCards-applyLabel-sGo "+i.a.locals.label+" hidden lg_block"},e.a=d}}])
